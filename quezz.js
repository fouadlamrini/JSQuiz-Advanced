// let  = {
//   Programation: [
//     {
//       Questionn: "Que signifie un élément sémantique en HTML ?",
//       Reponses: [
//         "Un élément qui donne du sens à son contenu et aide le SEO et les lecteurs automatiques",
//         "Un élément utilisé uniquement pour le style sans signification",
//         "Un élément réservé à JavaScript",
//         "Un élément qui change selon le navigateur",
//       ],
//       BonneReponse:
//         "Un élément qui donne du sens à son contenu et aide le SEO et les lecteurs automatiques",
//         plusOption:true,
//       NbrQst: "1/10",
//     },

//     {
//       Questionn:
//         "Quel est l’élément le plus approprié pour représenter un article autonome (self-contained article) ?",
//       Reponses: ["<div>", "<article>", "<span>", "<section>"],
//       BonneReponse: "<article>",
//        plusOption:false,
//       NbrQst: "2/10",
//     },
//     {
//       Questionn:
//         "Si on applique les règles suivantes au même élément : #id { color: red; } .class { color: blue; }, laquelle sera appliquée ?",
//       Reponses: [
//         ".class { color: blue; }",
//         "#id { color: red; }",
//         "La dernière dans le fichier peu importe le type",
//         "Le navigateur choisit le sélecteur le plus court",
//       ],
//       BonneReponse: "#id { color: red; }",
//        plusOption:false,
//       NbrQst: "3/10",
//     },
//     {
//       Questionn:
//         "Quelle propriété définit l’espace intérieur (distance entre le contenu et la bordure) ?",
//       Reponses: ["margin", "border", "padding", "outline"],
//       BonneReponse: "padding",
//        plusOption:false,
//       NbrQst: "4/10",
//     },
//     {
//       Questionn: "Qu’est-ce que le hoisting en JavaScript ?",
//       Reponses: [
//         "Le déplacement des déclarations de variables et fonctions en haut de leur portée avant exécution",
//         "La désactivation des variables",
//         "Une méthode pour accélérer le chargement des images",
//         "Ajouter des propriétés au DOM uniquement",
//       ],
//       BonneReponse:
//         "Le déplacement des déclarations de variables et fonctions en haut de leur portée avant exécution",
//          plusOption:true,
//       NbrQst: "5/10",
//     },
//     {
//       Questionn: "Quelle est la différence entre == et === en JavaScript ?",
//       Reponses: [
//         "Aucune différence",
//         "== compare après conversion de type, tandis que === compare type et valeur (strict)",
//         "== compare uniquement le type, === compare uniquement la valeur",
//         "=== n’est disponible qu’à partir d’ES6",
//       ],
//       BonneReponse:
//         "== compare après conversion de type, tandis que === compare type et valeur (strict)",
//          plusOption:false,
//       NbrQst: "6/10",
//     },
//     {
//       Questionn: ") Comment déclare-t-on une variable en PHP ?",
//       Reponses: ["var x = 5", "$x = 5", "x := 5", "let x = 5"],
//       BonneReponse: "$x = 5",
//        plusOption:false,
//       NbrQst: "7/10",
//     },
//     {
//       Questionn: "Qu’est-ce qu’une superglobale comme $_GET en PHP ?",
//       Reponses: [
//         "Une variable définie uniquement dans les fonctions",
//         "Un tableau accessible dans tous les contextes (global) sans global $var",
//         "Une variable utilisable une seule fois",
//         "Une variable contenant uniquement des fonctions",
//       ],
//       BonneReponse:
//         "Un tableau accessible dans tous les contextes (global) sans global $var",
//          plusOption:false,
//       NbrQst: "8/10",
//     },
//     {
//       Questionn: "Dans quel fichier définit-on les routes web dans Laravel ?",
//       Reponses: [
//         "routes/web.php",
//         "app/Http/routes.php",
//         "config/routes.php",
//         "public/index.php",
//       ],
//       BonneReponse: "routes/web.php",
//        plusOption:true,
//       NbrQst: "9/10",
//     },
//     {
//       Questionn:
//         "Quelle est la différence principale entre routes/web.php et routes/api.php dans Laravel ?",
//       Reponses: [
//         "Aucune différence",
//         "web.php est utilisé pour les interfaces web avec middleware (sessions, CSRF), tandis que api.php est",
//         "api.php est réservé aux fichiers statiques",
//         "web.php ne fonctionne qu’avec JSON",
//       ],
//       BonneReponse:
//         "web.php est utilisé pour les interfaces web avec middleware (sessions, CSRF), tandis que api.php est",
//          plusOption:false,
//       NbrQst: "10/10",
//     },
//   ],
//   Math: [
//     {
//       Questionn: "Quelle est la valeur de :7x8 ?",
//       Reponses: ["54", "56", "64", "58"],
//       BonneReponse: "56",
//        plusOption:true,
//       NbrQst: "1/10",
//     },

//     {
//       Questionn: "Quelle est la racine carrée de 144 ?",
//       Reponses: ["10", "11", "12", "14"],
//       BonneReponse: "12",
//        plusOption:false,
//       NbrQst: "2/10",
//     },
//     {
//       Questionn: "si x=5, quelle est la valeur de 2x^2+3?",
//       Reponses: ["48", "50", "53", "55"],
//       BonneReponse: "53",
//        plusOption:false,
//       NbrQst: "3/10",
//     },
//     {
//       Questionn: "Quelle est la fraction équivalente à 3/4",
//       Reponses: ["6/8", "8/12", "5/7", "9/16"],
//       BonneReponse: "6/8",
//        plusOption:false,
//       NbrQst: "4/10",
//     },
//     {
//       Questionn: "Résultat de :(15+5)/4",
//       Reponses: ["4", "5", "6", "8"],
//       BonneReponse: "5",
//        plusOption:true,
//       NbrQst: "5/10",
//     },
//     {
//       Questionn: "Quelle est la valeur de :3^4?",
//       Reponses: ["27", "64", "81", "243"],
//       BonneReponse: "81",
//        plusOption:false,
//       NbrQst: "6/10",
//     },
//     {
//       Questionn:
//         "Un triangle a des côtés de 3 cm, 4 cm et 5 cm. Ce triangle est :",
//       Reponses: ["Isocèle", "Rectangle", "Équilatéral", "Obtus"],
//       BonneReponse: "Rectangle",
//        plusOption:false,
//       NbrQst: "7/10",
//     },
//     {
//       Questionn:
//         "Si une pizza est coupée en 12 parts égales et que tu en manges 3, quelle fraction reste ?",
//       Reponses: ["1/4", "2/3", "3/4", "1/3"],
//       BonneReponse: "3/4",
//        plusOption:false,
//       NbrQst: "8/10",
//     },
//     {
//       Questionn: "La valeur de 2(x+3) quand x=4 est:",
//       Reponses: ["10", "12", "15", "14"],
//       BonneReponse: "14",
//        plusOption:true,
//       NbrQst: "9/10",
//     },
//     {
//       Questionn:
//         "Quelle est l’aire d’un rectangle de longueur 12 cm et de largeur 5 cm ?",
//       Reponses: ["17 cm²", "60 cm²", "24 cm²", "50 cm²"],
//       BonneReponse: "60 cm²",
//        plusOption:false,
//       NbrQst: "10/10",
//     },
//   ],
//   Sport: [
//     {
//       Questionn:
//         "Combien de joueurs y a-t-il dans une équipe de football sur le terrain ?",
//       Reponses: ["9", "10", "11", "12"],
//       BonneReponse: "11",
//        plusOption:true,
//       NbrQst: "1/10",
//     },

//     {
//       Questionn: "Quel pays a remporté la Coupe du Monde de football en 2018 ?",
//       Reponses: ["Allemagne", "France", "Brésil", "Argentine"],
//       BonneReponse: "France",
//        plusOption:false,
//       NbrQst: "2/10",
//     },
//     {
//       Questionn:
//         "Dans le basketball, combien de points vaut un tir à 3 points ?",
//       Reponses: ["1", "2", "3", "4"],
//       BonneReponse: "3",
//        plusOption:false,
//       NbrQst: "3/10",
//     },
//     {
//       Questionn: "Quel sport utilise une raquette et un volant ?",
//       Reponses: ["Tennis", "Badminton", "Squash", "Ping-pong"],
//       BonneReponse: "Badminton",
//        plusOption:false,
//       NbrQst: "4/10",
//     },
//     {
//       Questionn: "Le marathon a une distance officielle de :",
//       Reponses: ["40 km", "42,195 km", "45 km", "50 km"],
//       BonneReponse: "42,195 km",
//        plusOption:true,
//       NbrQst: "5/10",
//     },
//     {
//       Questionn:
//         "Quel joueur de tennis détient le plus de titres du Grand Chelem en simple masculin (2025) ?",
//       Reponses: [
//         "Roger Federer",
//         "Rafael Nadal",
//         "Novak Djokovic",
//         "Andy Murray",
//       ],
//       BonneReponse: "Rafael Nadal",
//        plusOption:false,
//       NbrQst: "6/10",
//     },
//     {
//       Questionn: "Dans quel sport utilise-t-on le terme “strike” ?",
//       Reponses: ["Baseball", "Football", "Rugby", "Handball"],
//       BonneReponse: "Baseball",
//        plusOption:false,
//       NbrQst: "7/10",
//     },
//     {
//       Questionn:
//         "Combien de joueurs y a-t-il dans une équipe de volleyball sur le terrain ?",
//       Reponses: ["5", "6", "7", "8"],
//       BonneReponse: "6",
//        plusOption:false,
//       NbrQst: "8/10",
//     },
//     {
//       Questionn:
//         "Quel pays est considéré comme le berceau des Jeux Olympiques ?",
//       Reponses: ["Italie", "Grèce", "France", "Égypte"],
//       BonneReponse: "Grèce",
//        plusOption:true,
//       NbrQst: "9/10",
//     },
//     {
//       Questionn: "Le Tour de France est une compétition de :",
//       Reponses: ["Natation", "Cyclisme", "Course à pied", "Triathlon"],
//       BonneReponse: "Cyclisme",
//        plusOption:false,
//       NbrQst: "10/10",
//     },
//   ],
// };
//Affichage des Questions
// //////////////////////////////////////////////////////////////
let clicked = false;
let next = false;
let allow = true;
let currentIndex = 0;

let category = JSON.parse(localStorage.getItem("utilisateurs"));

//  console.log(thermeChoisi[thermeChoisi.length-1].theme);
async function fetchData(x=currentIndex) {
  try {
    let url = `${category[category.length - 1].theme}.json`;
    let response = await fetch(url);
    if (!response.ok) {
      throw new Error("Response was not ok");
    }
    let data = await response.json();
    console.log(data);
    let question = document.getElementById("question");
let choix1 = document.getElementById("choix1");
let choix2 = document.getElementById("choix2");
let choix3 = document.getElementById("choix3");
let choix4 = document.getElementById("choix4");
let nbr_question = document.getElementById("nbr_question");
question.textContent = data[x].Questionn;
choix1.textContent = data[x].Reponses[0];
choix2.textContent = data[x].Reponses[1];
choix3.textContent = data[x].Reponses[2];
choix4.textContent = data[x].Reponses[3];
nbr_question.textContent = data[x].NbrQst;
console.log(x);
x++;

  } catch (error) {
    console.log(error);
  }
}
fetchData();
let btnSuivant = document.getElementById("suivant");
btnSuivant.addEventListener("click", () => {
  currentIndex++;
  fetchData();
});

let btnAccept = document.getElementById("accept");


// function afficherQst(x) {
  
//   if (next) {
//     allow = true;
//     time.textContent = 15;
//     next = false;
//     clicked = false;
//     NumQst += x;
//     let options = document.querySelectorAll(".option");
//     options.forEach((option) => {
//       let label = option.querySelector("label");
//       label.style.backgroundColor = "";
//     });

//     if (NumQst > [data[data.length - 1]].length - 1) {
//       btnSuivant.textContent = "Valider";
//       btnSuivant.classList.add("valider");
//       document
//         .getElementsByClassName("valider")[0]
//         .addEventListener("click", function () {
//           window.location.href = "rapport.html";
//         });
//       clearInterval(timeQcm);
//     } else if (NumQst < 0) {
//       NumQst = [data[data.length - 1]].length - 1;
//     } else {
//       btnSuivant.textContent = "Suivant";
//       btnSuivant.classList.remove("valider");
//     }
//     question.textContent = [data[data.length - 1]][
//       NumQst
//     ].Questionn;
//     choix1.textContent = [data[data.length - 1]][
//       NumQst
//     ].Reponses[0];
//     choix2.textContent = [data[data.length - 1]][
//       NumQst
//     ].Reponses[1];
//     choix3.textContent = [data[data.length - 1]][
//       NumQst
//     ].Reponses[2];
//     choix4.textContent = [data[category.length - 1]][
//       NumQst
//     ].Reponses[3];
//     nbr_question.textContent = [category[category.length - 1]][
//       NumQst
//     ].NbrQst;
//   }
// }
// setInterval(afficherQst, 15000, 1);

let time = document.getElementById("time");
time.textContent = 15;
let timeQcm = setInterval(() => {
  if (allow) {
    time.textContent--;
    if (time.textContent == 0) {
      fetchData(1);
      saveResult("", "", "");
      time.textContent = 15;
    }
  }
}, 1000);

function optionChoisir() {
  let paragraphContenu;
  let score = 0;
  let score2 = document.getElementById("score");
  let options = document.querySelectorAll(".option");
  let answerInput = document.querySelectorAll(".answerInput");
  options.forEach((option) => {
    option.addEventListener("click", () => {
      if (!clicked) {
        allow = false;
        next = true;
        for (let i = 0; i < answerInput.length; i++) {
          answerInput[i].disabled = true;
        }
        paragraphContenu = option.querySelector("span").textContent;
        let answerCOrrect = [category[category.length - 1]["theme"]][NumQst]
          .BonneReponse;
        let label = option.querySelector("label");

        if (paragraphContenu === answerCOrrect) {
          label.style.backgroundColor = "lightgreen";
          score += 10;
          label.style.display = "disable";
        } else {
          label.style.backgroundColor = "#ff7f7f";
        }
        score2.textContent = score;
        clicked = true;
        saveResult(paragraphContenu, answerCOrrect, score);
      }
    });
  });
}
optionChoisir();

function saveResult(reponseChoisie, correctAnswer, score) {
  const stocker = localStorage.getItem("utilisateurs");
  if (!stocker) return;

  let utilisateurs = JSON.parse(stocker);
  let lastUser = utilisateurs[utilisateurs.length - 1];

  lastUser.answers.push({
    reponseChoisie: reponseChoisie,
    correctAnswer: correctAnswer,
  });
  lastUser.score = score;

  localStorage.setItem("utilisateurs", JSON.stringify(utilisateurs));
}
